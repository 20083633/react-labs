(this.webpackJsonpsalssubs=this.webpackJsonpsalssubs||[]).push([[7],{221:function(e,r,t){"use strict";t.r(r);var a=t(97),s=t(20),l=t(0),n=t.n(l),o=t(208),i=t(192),u=t(105),c=t(191),d=t(228),m=t(222),h=t(77),p=t(10),b=t(108),f=t(109),j=t(51),g=t(2);r.default=Object(p.g)((function(e){var r=Object(l.useContext)(j.a),t=Object(l.useState)({totalPrice:e.location.state.order.totalPrice,chosenFillings:e.location.state.order.chosenFillings}),p=Object(s.a)(t,2),v=p[0],O=(p[1],Object(l.useState)({error:!1,errorMessage:null})),x=Object(s.a)(O,2),y=x[0],k=x[1],C=Object(l.useState)({details:{name:"",phone:"",method:"",address:""}}),q=Object(s.a)(C,2),P=q[0],w=q[1],A=Object(l.useState)({rules:[{id:"form-input-name",message:"Please enter your name",required:!0,valid:!1},{id:"form-input-phone",message:"Please enter your phone number",required:!0,valid:!1},{id:"form-select-method",message:"Please choose collection or delivery",required:!0,valid:!1},{id:"form-input-address",message:"Please enter your delivery address",required:!1,valid:!0}],formValid:!1}),F=Object(s.a)(A,2),S=F[0],D=F[1],M=Object(l.useState)({name:null,phone:null,method:null,address:null}),I=Object(s.a)(M,2),J=I[0],z=I[1],N=function(e,r,t){var s=Object(a.a)({},S),l=s.rules.findIndex((function(e){return e.id===r})),n=null;if(s.rules[l].required&&"input"===t&&""===e.trim())n=s.rules[l].message,s.rules[l].valid=!1;else if("form-input-name"===r){/^[A-Za-z\s]{2,30}$/.test(e)?s.rules[l].valid=!0:(s.rules[l].valid=!1,n=s.rules[l].message)}else if("form-input-phone"===r){/^[+]?[(]?[0-9]{3,5}[)]?[-\s.]?[0-9]{6,7}$/.test(e)?s.rules[l].valid=!0:(s.rules[l].valid=!1,n=s.rules[l].message)}else if("Delivery"===e)s.rules[l].valid=!0,s.rules[3].valid=!1,s.rules[3].required=!0;else if("Collection"===e)s.rules[l].valid=!0,s.rules[3].required=!1,s.rules[3].valid=!0;else if(s.rules[l].required&&"form-input-address"===r){/^[#.0-9a-zA-Z\s,-]{2,50}$/.test(e)?s.rules[l].valid=!0:(s.rules[l].valid=!1,n=s.rules[l].message)}else n=null,s.rules[l].valid=!0;console.log(n);var o=Object(a.a)({},J);switch(r){case"form-input-name":o.name=n;break;case"form-input-phone":o.phone=n;break;case"form-select-method":o.method=n;break;case"form-input-address":o.address=n;break;default:o=Object(a.a)({},J)}z(Object(a.a)({},o));var i=!0;for(var u in s.rules)s.rules[u].valid||(i=!1);console.log(i),D({rules:s.rules,formValid:i})},T=function(e,r,t){var a=P.details;switch(r){case"form-input-name":a.name=e.target.value,N(e.target.value,r,t);break;case"form-input-phone":a.phone=e.target.value,N(e.target.value,r,t);break;case"form-select-method":a.method=e.target.textContent,N(e.target.textContent,r,t);break;case"form-input-address":a.address=e.target.value,N(e.target.value,r,t)}w({details:a})},V=!S.formValid,$=null;return $=y.error?Object(g.jsx)(f.a,{error:y.errorMessage,onClear:function(){k({error:!1,errorMessage:null})}}):Object(g.jsx)(o.a,{children:Object(g.jsxs)(o.a.Row,{columns:2,children:[Object(g.jsx)(o.a.Column,{width:6,children:Object(g.jsxs)(i.a,{color:"green",children:[Object(g.jsx)(u.a,{as:"h2",textAlign:"center",color:"green",children:"Confirm your order:"}),Object(g.jsx)(h.a,{menu:e.location.state.menu,chosenFillings:v.chosenFillings,totalPrice:v.totalPrice}),Object(g.jsx)(c.a,{color:"green",onClick:function(){e.history.push({pathname:"/",state:{order:v}})},children:"Go Back"})]})}),Object(g.jsx)(o.a.Column,{width:10,children:Object(g.jsxs)(i.a,{color:"green",children:[Object(g.jsx)(u.a,{as:"h2",textAlign:"center",color:"green",children:"Enter your details:"}),Object(g.jsxs)(d.a,{children:[Object(g.jsx)(d.a.Input,{error:J.name,required:!0,label:"Name",placeholder:"Name",id:"form-input-name",onChange:function(e){return T(e,"form-input-name","input")}}),Object(g.jsx)(d.a.Input,{error:J.phone,required:!0,label:"Phone",placeholder:"Phone",id:"form-input-phone",onChange:function(e){return T(e,"form-input-phone","input")}}),Object(g.jsx)(d.a.Field,{control:m.a,required:!0,error:J.method,label:"Delivery method",options:[{key:"c",text:"Collection",value:"collection"},{key:"d",text:"Delivery",value:"delivery"}],placeholder:"Collection or Delivery",id:"form-select-method",onChange:function(e){return T(e,"form-select-method","select")}}),Object(g.jsx)(d.a.Input,{error:J.address,required:S.rules[3].required,fluid:!0,label:"Address",placeholder:"Address",id:"form-input-address",onChange:function(e){return T(e,"form-input-address","input")}}),Object(g.jsx)(c.a,{type:"submit",color:"green",disabled:V,onClick:function(){var t=v;t.userId=r.userId;var a=new Date,s=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][a.getDay()],l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a.getMonth()],n=s+" "+a.getDate()+" "+l+" "+a.getFullYear();t.date=n,t.details=P.details,b.a.post("/checkout",t,{headers:{Authorization:"Bearer "+r.token}}).then((function(r){e.history.push("/success")})).catch((function(e){console.log(e);var r="";r=e.response?e.response.data.message:"There was a problem creating your order",k({error:!0,errorMessage:r})}))},children:"Submit"})]})]})})]})}),Object(g.jsx)(n.a.Fragment,{children:$})}))}}]);
//# sourceMappingURL=7.9f5548eb.chunk.js.map