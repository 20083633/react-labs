(this.webpackJsonpsalssubs=this.webpackJsonpsalssubs||[]).push([[1],{108:function(e,n,t){"use strict";var c=t(145),i=t.n(c).a.create({baseURL:"https://salssubs.herokuapp.com/api"});n.a=i},109:function(e,n,t){"use strict";var c=t(20),i=t(0),s=t.n(i),r=t(66),a=t(191),l=t(2);n.a=function(e){var n=s.a.useState(!!e.error),t=Object(c.a)(n,2),i=t[0],o=t[1];return Object(l.jsxs)(r.a,{onClose:function(){return o(!1)},onOpen:function(){return o(!0)},open:i,children:[Object(l.jsx)(r.a.Header,{children:"Something went wrong"}),Object(l.jsx)(r.a.Content,{children:Object(l.jsx)(r.a.Description,{children:Object(l.jsx)("p",{children:e.error})})}),Object(l.jsx)(r.a.Actions,{children:Object(l.jsx)(a.a,{content:"Okay",onClick:function(){e.onClear(),o(!1)},color:"red"})})]})}},160:function(e,n,t){},161:function(e,n,t){},169:function(e,n,t){},189:function(e,n,t){"use strict";t.r(n);var c,i=t(0),s=t.n(i),r=t(47),a=t.n(r),l=(t(160),t(161),t(162),t(20)),o=t(205),u=t(10),j=t(68),d=(t(169),t(206)),h=t(26),b=t(51),g=t(2),O=function(e){var n=Object(i.useContext)(b.a);return Object(g.jsx)("div",{children:Object(g.jsxs)(d.a,{color:"green",stackable:!0,inverted:!0,children:[Object(g.jsx)(d.a.Item,{children:Object(g.jsx)("img",{src:"images/logo.png",alt:"Sals Subs Logo"})}),Object(g.jsx)(d.a.Item,{as:h.c,to:"/",exact:!0,children:"Sal's Subs"}),n.isLoggedIn&&Object(g.jsx)(d.a.Item,{as:h.c,to:"/orders/".concat(n.userId),children:"Previous Orders"}),n.isLoggedIn&&Object(g.jsx)(d.a.Item,{as:h.c,to:"/users/".concat(n.userId),children:"Your Account"}),!n.isLoggedIn&&Object(g.jsx)(d.a.Menu,{position:"right",children:Object(g.jsx)(d.a.Item,{as:h.c,to:"/authenticate",children:"Signup/Login"})}),n.isLoggedIn&&Object(g.jsx)(d.a.Menu,{position:"right",children:Object(g.jsx)(d.a.Item,{as:h.c,to:"/",onClick:n.logout,children:"Log out"})})]})})},x=t(97),f=t(208),m=t(192),p=t(105),v=t(146),F=t(93),S=function(e){return Object(g.jsxs)(f.a.Column,{mobile:4,computer:2,textAlign:"center",children:[Object(g.jsx)(v.a,{src:e.image,alt:e.alt,size:"tiny",centered:!0}),Object(g.jsxs)(F.a,{pointing:!0,children:["\u20ac ",e.price.toFixed(2)," "]})]})},C=function(e){return Object(g.jsxs)(f.a.Column,{width:12,children:[Object(g.jsx)(m.a,{color:"green",children:Object(g.jsx)(p.a,{as:"h2",textAlign:"center",color:"green",children:"Sal's Subs Menu"})}),Object(g.jsx)(f.a,{children:e.menu.map((function(e,n){return Object(g.jsx)(S,{image:e.image,alt:e.alt,price:e.price},e.id)}))})]})},k=t(193),I=t(191),P=t(44),w=function(e){return Object(g.jsxs)(f.a.Column,{mobile:4,computer:2,textAlign:"center",children:[Object(g.jsx)("p",{children:e.alt}),Object(g.jsxs)(I.a.Group,{size:"mini",children:[Object(g.jsx)(I.a,{color:"green",icon:!0,onClick:e.added,children:Object(g.jsx)(P.a,{name:"plus"})}),Object(g.jsx)(I.a,{color:"red",icon:!0,onClick:e.removed,children:Object(g.jsx)(P.a,{name:"minus"})})]})]})},L=function(e){return Object(g.jsxs)(f.a.Column,{width:8,children:[Object(g.jsx)(p.a,{as:"h2",textAlign:"center",className:"step",children:"Step 1: Choose your fillings"}),Object(g.jsx)(f.a,{children:e.menu.map((function(n,t){return Object(g.jsx)(w,{alt:n.alt,added:function(){return e.fillingAdded(n.id)},removed:function(){return e.fillingRemoved(n.id)}},n.id)}))})]})},y=t(77),A=t(66),z=function(e){var n=Object(i.useState)(!1),t=Object(l.a)(n,2),c=t[0],s=t[1];return Object(g.jsxs)(A.a,{onClose:function(){return s(!1)},onOpen:function(){return s(!0)},open:c,trigger:Object(g.jsx)(I.a,{color:"green",size:"large",children:"Order Now!"}),children:[Object(g.jsx)(A.a.Header,{children:"Confirm your choices:"}),Object(g.jsx)(A.a.Content,{children:Object(g.jsx)(y.a,{menu:e.menu,chosenFillings:e.chosenFillings,totalPrice:e.totalPrice})}),Object(g.jsxs)(A.a.Actions,{children:[Object(g.jsx)(I.a,{color:"red",onClick:function(){return s(!1)},children:"Go Back"}),Object(g.jsx)(I.a,{color:"green",disabled:e.disabled,onClick:function(){e.checkout(),s(!1)},children:"Check out"})]})]})},D=function(e){return Object(g.jsxs)(f.a.Column,{width:6,textAlign:"right",children:[Object(g.jsx)(p.a,{as:"h2",textAlign:"center",className:"step",children:"Step 2: Check out"}),Object(g.jsx)(y.a,{menu:e.menu,chosenFillings:e.chosenFillings,totalPrice:e.totalPrice}),Object(g.jsx)(z,{menu:e.menu,chosenFillings:e.chosenFillings,totalPrice:e.totalPrice,checkout:e.checkout,disabled:e.disabled})]})},T=function(e){var n=!Object(i.useContext)(b.a).isLoggedIn;return Object(g.jsx)(f.a.Row,{children:Object(g.jsxs)(k.a.Dimmable,{as:f.a,blurring:!0,dimmed:n,children:[Object(g.jsxs)(f.a.Row,{columns:2,centered:!0,children:[Object(g.jsx)(L,{menu:e.menu,fillingAdded:e.fillingAdded,fillingRemoved:e.fillingRemoved}),Object(g.jsx)(D,{menu:e.menu,chosenFillings:e.chosenFillings,totalPrice:e.totalPrice,checkout:e.checkout,disabled:e.disabled})]}),Object(g.jsxs)(k.a,{active:n,children:[Object(g.jsx)(p.a,{as:"h2",inverted:!0,children:"Log in to start creating your pizza!"}),Object(g.jsx)(I.a,{as:h.b,to:"/authenticate",color:"green",size:"large",children:"Signup/Login"})]})]})})},M=t(108),R=t(109),N=function(e){var n=Object(i.useState)({fillings:[]}),t=Object(l.a)(n,2),c=t[0],s=t[1],r=Object(i.useState)({error:!1,errorMessage:null}),a=Object(l.a)(r,2),o=a[0],u=a[1],d=Object(i.useState)({isLoading:!0,loadFailed:!1}),h=Object(l.a)(d,2),b=h[0],O=h[1];Object(i.useEffect)((function(){M.a.get("/").then((function(e){var n=e.data.fillings.sort((function(e,n){return e.id-n.id}));s({fillings:n})})).catch((function(e){var n="";n=e.response?e.response.data.message:"There was a problem loading the menu",u({error:!0,errorMessage:n}),O({isLoading:!1,loadFailed:c.loadFailed}),console.log(e.response)}))}),[]);var m=Object(i.useState)({totalPrice:e.location.state?e.location.state.order.totalPrice:5,chosenFillings:e.location.state?e.location.state.order.chosenFillings:[]}),p=Object(l.a)(m,2),v=p[0],F=p[1];window.history.replaceState("/",void 0);console.log(v);var S=!0;v.chosenFillings.length>0&&(S=!1);var k=o.error?Object(g.jsx)(R.a,{error:o.errorMessage,onClear:function(){u({error:!1,errorMessage:null}),O({isLoading:!1,loadFailed:!0})}}):Object(g.jsx)(j.a,{active:b.isLoading});return c.fillings.length>0?k=Object(g.jsxs)(f.a,{divided:"vertically",stackable:!0,children:[Object(g.jsx)(f.a.Row,{centered:!0,children:Object(g.jsx)(C,{menu:c.fillings})}),Object(g.jsx)(T,{menu:c.fillings,fillingAdded:function(e){var n=Object(x.a)({},v),t=c.fillings.findIndex((function(n){return n.id===e})),i=n.chosenFillings.findIndex((function(n){return n.id===e}));if(i>-1)n.chosenFillings[i].count++;else{var s={id:c.fillings[t].id,name:c.fillings[t].alt,price:c.fillings[t].price,count:1};n.chosenFillings.push(s)}var r=v.totalPrice+c.fillings[t].price;F({totalPrice:r,chosenFillings:n.chosenFillings})},fillingRemoved:function(e){var n=Object(x.a)({},v),t=n.chosenFillings.findIndex((function(n){return n.id===e})),c=n.totalPrice;t>=0&&(c-=n.chosenFillings[t].price,n.chosenFillings[t].count--,n.chosenFillings[t].count<1&&n.chosenFillings.splice(t,1)),F({totalPrice:c,chosenFillings:n.chosenFillings})},chosenFillings:v.chosenFillings,totalPrice:v.totalPrice,checkout:function(){e.history.push("/place-order"),e.history.push({pathname:"place-order",state:{order:v,menu:c.fillings}})},disabled:S})]}):b.loadFailed&&(k=Object(g.jsx)("p",{children:"We're having some issues loading the menu... Please try again later."})),Object(g.jsx)("div",{children:k})},E=s.a.lazy((function(){return t.e(9).then(t.bind(null,229))})),J=s.a.lazy((function(){return Promise.all([t.e(0),t.e(7)]).then(t.bind(null,221))})),B=s.a.lazy((function(){return t.e(8).then(t.bind(null,223))})),G=s.a.lazy((function(){return Promise.all([t.e(0),t.e(6)]).then(t.bind(null,224))})),H=s.a.lazy((function(){return t.e(4).then(t.bind(null,230))})),Y=s.a.lazy((function(){return Promise.all([t.e(0),t.e(5)]).then(t.bind(null,225))})),U=function(e){var n,t=Object(i.useState)(!1),s=Object(l.a)(t,2),r=s[0],a=s[1],d=Object(i.useState)(!1),h=Object(l.a)(d,2),x=h[0],f=h[1],m=Object(i.useState)(),p=Object(l.a)(m,2),v=p[0],F=p[1],S=Object(u.f)(),C=Object(i.useCallback)((function(e,n,t){a(n),f(e);var c=t||new Date((new Date).getTime()+36e5);F(c),localStorage.setItem("userData",JSON.stringify({userId:e,token:n,expiration:c.toISOString()}))}),[]),k=Object(i.useCallback)((function(){a(null),F(null),f(null),localStorage.removeItem("userData"),S.push("/")}),[]);return Object(i.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userData"));e&&e.token&&new Date(e.expiration)>new Date&&C(e.userId,e.token,new Date(e.expiration))}),[C]),Object(i.useEffect)((function(){if(r&&v){var e=v.getTime()-(new Date).getTime();c=setTimeout(k,e)}else clearTimeout(c)}),[r,k,v]),n=r?Object(g.jsxs)(u.c,{children:[Object(g.jsx)(u.a,{path:"/",exact:!0,component:N}),Object(g.jsx)(u.a,{path:"/orders/:uid",component:E}),Object(g.jsx)(u.a,{path:"/place-order",component:J}),Object(g.jsx)(u.a,{path:"/success",component:B}),Object(g.jsx)(u.a,{path:"/users/:uid",component:H}),Object(g.jsx)(u.a,{path:"/update-account",component:Y})]}):Object(g.jsxs)(u.c,{children:[Object(g.jsx)(u.a,{path:"/",exact:!0,component:N}),Object(g.jsx)(u.a,{path:"/authenticate",component:G})]}),Object(g.jsx)(b.a.Provider,{value:{isLoggedIn:!!r,token:r,userId:x,login:C,logout:k},children:Object(g.jsxs)(o.a,{children:[Object(g.jsx)(O,{}),Object(g.jsx)(i.Suspense,{fallback:Object(g.jsx)("div",{children:Object(g.jsx)(j.a,{active:"true"})}),children:n})]})})};var W=function(){return Object(g.jsx)(h.a,{children:Object(g.jsx)(U,{})})},q=function(e){e&&e instanceof Function&&t.e(10).then(t.bind(null,226)).then((function(n){var t=n.getCLS,c=n.getFID,i=n.getFCP,s=n.getLCP,r=n.getTTFB;t(e),c(e),i(e),s(e),r(e)}))};a.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(W,{})}),document.getElementById("root")),q()},51:function(e,n,t){"use strict";var c=t(0),i=Object(c.createContext)({isLoggedIn:!1,login:function(){},logout:function(){}});n.a=i},68:function(e,n,t){"use strict";t(0);var c=t(192),i=t(193),s=t(190),r=t(2);n.a=function(e){return Object(r.jsx)(c.a,{children:Object(r.jsx)(i.a,{active:e.active,inverted:!0,children:Object(r.jsx)(s.a,{size:"large",children:"Loading"})})})}},77:function(e,n,t){"use strict";t(0);var c=t(105),i=t(147),s=t(2);n.a=function(e){var n=null;return n=e.chosenFillings.length>0?Object(s.jsxs)("div",{children:[Object(s.jsx)(c.a,{as:"h3",children:"Your Sub:"}),Object(s.jsx)(i.a,{divided:!0,verticalAlign:"middle",children:e.chosenFillings.map((function(e){return Object(s.jsxs)(i.a.Item,{children:[e.name,": ",e.count]},e.id)}))}),Object(s.jsxs)(c.a,{as:"h4",className:"h4margin",children:["Total Price: \u20ac ",e.totalPrice.toFixed(2)]})]}):Object(s.jsx)("div",{children:Object(s.jsx)(c.a,{as:"h4",className:"h4margin",children:"Start adding some fillings!"})}),Object(s.jsx)("div",{children:n})}}},[[189,2,3]]]);
//# sourceMappingURL=main.8501f2d9.chunk.js.map